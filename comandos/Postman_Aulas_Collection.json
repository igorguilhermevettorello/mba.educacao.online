{
	"info": {
		"_postman_id": "aulas-crud-collection",
		"name": "MBA Educação Online - CRUD Aulas",
		"description": "Coleção completa de testes para os endpoints de CRUD de Aulas",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{access_token}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "base_url",
			"value": "https://localhost:7007",
			"type": "string"
		},
		{
			"key": "curso_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "aula_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "1. Autenticação",
			"item": [
				{
					"name": "Login Administrador",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.accessToken) {",
									"        pm.collectionVariables.set('access_token', jsonData.data.accessToken);",
									"        pm.environment.set('access_token', jsonData.data.accessToken);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"admin@admin.com\",\n  \"senha\": \"Admin@123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/home/login",
							"host": ["{{base_url}}"],
							"path": ["api", "home", "login"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Cursos (Pré-requisito)",
			"item": [
				{
					"name": "Criar Curso para Testes",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data) {",
									"        pm.collectionVariables.set('curso_id', jsonData.data);",
									"        pm.environment.set('curso_id', jsonData.data);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"titulo\": \"Curso de Teste para Aulas\",\n  \"descricao\": \"Curso criado especificamente para testar o CRUD de aulas\",\n  \"instrutor\": \"Professor Teste\",\n  \"nivel\": 1,\n  \"valor\": 500.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cursos",
							"host": ["{{base_url}}"],
							"path": ["api", "cursos"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "3. Aulas - CREATE",
			"item": [
				{
					"name": "Criar Aula",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test('Resposta contém ID da aula', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data).to.not.be.null;",
									"    pm.collectionVariables.set('aula_id', jsonData.data);",
									"    pm.environment.set('aula_id', jsonData.data);",
									"});",
									"",
									"pm.test('Mensagem de sucesso', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.message).to.eql('Aula criada com sucesso');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"cursoId\": \"{{curso_id}}\",\n  \"titulo\": \"Introdução ao ASP.NET Core\",\n  \"descricao\": \"Nesta aula você aprenderá os conceitos básicos do ASP.NET Core e sua arquitetura\",\n  \"duracaoMinutos\": 90,\n  \"ordem\": 1\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"]
						}
					},
					"response": []
				},
				{
					"name": "Criar Segunda Aula",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"cursoId\": \"{{curso_id}}\",\n  \"titulo\": \"Clean Architecture na Prática\",\n  \"descricao\": \"Implementando Clean Architecture em projetos .NET Core\",\n  \"duracaoMinutos\": 120,\n  \"ordem\": 2\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"]
						}
					},
					"response": []
				},
				{
					"name": "Criar Aula - Validação (Sem Título)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 400', function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test('Contém erros de validação', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.errors).to.not.be.null;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"cursoId\": \"{{curso_id}}\",\n  \"titulo\": \"\",\n  \"descricao\": \"Descrição da aula sem título\",\n  \"duracaoMinutos\": 60,\n  \"ordem\": 3\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"]
						}
					},
					"response": []
				},
				{
					"name": "Criar Aula - Curso Inexistente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 400', function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"cursoId\": \"00000000-0000-0000-0000-000000000000\",\n  \"titulo\": \"Aula com curso inexistente\",\n  \"descricao\": \"Esta aula não deve ser criada\",\n  \"duracaoMinutos\": 60,\n  \"ordem\": 1\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Aulas - READ",
			"item": [
				{
					"name": "Obter Aula por ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Resposta contém dados da aula', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data).to.not.be.null;",
									"    pm.expect(jsonData.data.id).to.eql(pm.collectionVariables.get('aula_id'));",
									"    pm.expect(jsonData.data.titulo).to.not.be.null;",
									"    pm.expect(jsonData.data.descricao).to.not.be.null;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "Obter Aula - ID Inexistente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 404', function () {",
									"    pm.response.to.have.status(404);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/00000000-0000-0000-0000-000000000000",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "00000000-0000-0000-0000-000000000000"]
						}
					},
					"response": []
				},
				{
					"name": "Listar Todas as Aulas",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Resposta contém lista de aulas', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data).to.be.an('array');",
									"    pm.expect(jsonData.data.length).to.be.greaterThan(0);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"]
						}
					},
					"response": []
				},
				{
					"name": "Listar Aulas por Curso",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Todas as aulas pertencem ao curso', function () {",
									"    var jsonData = pm.response.json();",
									"    var cursoId = pm.collectionVariables.get('curso_id');",
									"    jsonData.data.forEach(function(aula) {",
									"        pm.expect(aula.cursoId).to.eql(cursoId);",
									"    });",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas?cursoId={{curso_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"],
							"query": [
								{
									"key": "cursoId",
									"value": "{{curso_id}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Listar Apenas Aulas Ativas",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Todas as aulas estão ativas', function () {",
									"    var jsonData = pm.response.json();",
									"    jsonData.data.forEach(function(aula) {",
									"        pm.expect(aula.ativa).to.be.true;",
									"    });",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas?apenasAtivas=true",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas"],
							"query": [
								{
									"key": "apenasAtivas",
									"value": "true"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "5. Aulas - UPDATE",
			"item": [
				{
					"name": "Atualizar Aula",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Mensagem de sucesso', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.message).to.eql('Aula atualizada com sucesso');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"titulo\": \"Introdução ao ASP.NET Core - Atualizado\",\n  \"descricao\": \"Nesta aula você aprenderá os conceitos básicos e avançados do ASP.NET Core\",\n  \"duracaoMinutos\": 120,\n  \"ordem\": 1\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "Atualizar Aula - Validação (Duração Inválida)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 400', function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"titulo\": \"Aula com duração inválida\",\n  \"descricao\": \"Descrição da aula\",\n  \"duracaoMinutos\": 0,\n  \"ordem\": 1\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "Atualizar Aula - ID Inexistente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 400', function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"titulo\": \"Aula inexistente\",\n  \"descricao\": \"Tentando atualizar aula que não existe\",\n  \"duracaoMinutos\": 60,\n  \"ordem\": 1\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/aulas/00000000-0000-0000-0000-000000000000",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "00000000-0000-0000-0000-000000000000"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "6. Aulas - ATIVAR/INATIVAR",
			"item": [
				{
					"name": "Inativar Aula",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Mensagem de sucesso', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.message).to.eql('Aula inativada com sucesso');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}/inativar",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}", "inativar"]
						}
					},
					"response": []
				},
				{
					"name": "Verificar Aula Inativada",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Aula está inativa', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.ativa).to.be.false;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "Ativar Aula",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Mensagem de sucesso', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.message).to.eql('Aula ativada com sucesso');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}/ativar",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}", "ativar"]
						}
					},
					"response": []
				},
				{
					"name": "Verificar Aula Ativada",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Aula está ativa', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.ativa).to.be.true;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "7. Aulas - DELETE",
			"item": [
				{
					"name": "Deletar Aula",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Mensagem de sucesso', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.message).to.eql('Aula deletada com sucesso');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "Verificar Aula Deletada",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 404', function () {",
									"    pm.response.to.have.status(404);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/{{aula_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "{{aula_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "Deletar Aula - ID Inexistente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code é 400', function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/aulas/00000000-0000-0000-0000-000000000000",
							"host": ["{{base_url}}"],
							"path": ["api", "aulas", "00000000-0000-0000-0000-000000000000"]
						}
					},
					"response": []
				}
			]
		}
	]
}

